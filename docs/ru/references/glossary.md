# Глоссарий

Кросс-доменный глоссарий ключевых терминов, используемых в документации NextStat.
Термины сгруппированы по доменам; общие термины идут первыми.

> **Соглашение:** аббревиатуры в публичных документах должны расшифровываться при первом использовании
> (см. `docs/references/terminology.md`).

---

## Общая статистика

| Термин | Определение |
|--------|------------|
| **MLE** | Оценка максимального правдоподобия (Maximum Likelihood Estimation) — поиск значений параметров, максимизирующих правдоподобие наблюдаемых данных. |
| **NLL** | Отрицательное логарифмическое правдоподобие (Negative Log-Likelihood) — целевая функция, минимизируемая при MLE. Чем меньше — тем лучше. |
| **Градиент** | Вектор частных производных NLL по каждому параметру. Используется оптимизатором L-BFGS-B. |
| **Гессиан** | Матрица вторых производных NLL. Её обращение приближает ковариационную матрицу оценок параметров. |
| **Ковариационная матрица** | Квадратная матрица, описывающая совместную неопределённость всех параметров. Диагональные элементы — дисперсии, внедиагональные — корреляции. |
| **Доверительный интервал (CI)** | Частотный интервал `[lo, hi]`: при повторных экспериментах он содержит истинное значение с заявленной вероятностью покрытия. |
| **Кредибельный интервал** | Байесовский интервал, содержащий истинное значение с заявленной апостериорной вероятностью. |
| **p-значение** | Вероятность наблюдать данные не менее экстремальные, чем текущие, при условии истинности нулевой гипотезы. |
| **Мешающий параметр (NP)** | Параметр модели, не представляющий прямого интереса, но требующий учёта (например, систематические неопределённости). |
| **Параметр интереса (POI)** | Основная измеряемая или проверяемая величина (например, сила сигнала μ). |
| **Штрафной член (constraint)** | Слагаемое в NLL, кодирующее априорное знание о мешающем параметре (обычно гауссово). |
| **Профильное правдоподобие** | Правдоподобие, вычисленное при наилучших значениях мешающих параметров для каждого фиксированного значения POI. |
| **L-BFGS-B** | Ограниченный по памяти алгоритм Бройдена—Флетчера—Гольдфарба—Шанно с ограничениями в виде прямоугольника — оптимизатор NextStat по умолчанию. |

## Регрессия и GLM

| Термин | Определение |
|--------|------------|
| **GLM** | Обобщённая линейная модель — расширяет линейную регрессию на ненормальные распределения отклика через функцию связи. |
| **Функция связи** | Отображает линейный предиктор в математическое ожидание распределения отклика (например, логит для бинарных исходов). |
| **Логистическая регрессия** | GLM с логит-связью для бинарной классификации. |
| **Пуассоновская регрессия** | GLM с логарифмической связью для счётных данных. |
| **Отрицательная биномиальная регрессия** | GLM для сверхдисперсных счётных данных (дисперсия > среднего). |
| **Робастные стандартные ошибки (HC)** | Стандартные ошибки, устойчивые к гетероскедастичности; корректны при неправильной спецификации модели дисперсии. |

## Байесовский вывод

| Термин | Определение |
|--------|------------|
| **NUTS** | No-U-Turn Sampler — адаптивный алгоритм HMC, автоматически подбирающий длину траектории. MCMC-сэмплер NextStat по умолчанию. |
| **HMC** | Гамильтоновский Монте-Карло — использует градиент для предложения далёких сэмплов с высокой вероятностью принятия. |
| **Апостериорное распределение** | Распределение параметров при условии наблюдённых данных; пропорционально правдоподобие × априорное. |
| **MAP** | Максимум апостериорной вероятности — мода апостериорного распределения; эквивалент штрафной MLE. |
| **ESS** | Эффективный размер выборки — оценивает, скольким независимым сэмплам эквивалентна коррелированная MCMC-цепочка. |
| **R-hat (R̂)** | Диагностика сходимости, сравнивающая внутрицепочечную и межцепочечную дисперсию. Значения близкие к 1.0 указывают на сходимость. |
| **Аппроксимация Лапласа** | Приближает апостериорное распределение гауссианом с центром в MAP и ковариацией из обратного гессиана. |

## Иерархические / смешанные модели

| Термин | Определение |
|--------|------------|
| **LMM** | Линейная смешанная модель — регрессия с фиксированными (популяционными) и случайными (групповыми) эффектами. |
| **GLMM** | Обобщённая линейная смешанная модель — расширяет LMM на негауссовские отклики. |
| **Фиксированные эффекты** | Коэффициенты, оцениваемые на уровне популяции, общие для всех групп. |
| **Случайные эффекты** | Групповые отклонения от популяционного среднего, распределённые по закону (обычно нормальному). |
| **Маржинальное правдоподобие** | Правдоподобие с аналитически проинтегрированными случайными эффектами (для гауссовских LMM). |

## Временные ряды и пространство состояний

| Термин | Определение |
|--------|------------|
| **Фильтр Калмана** | Рекурсивный алгоритм оптимальной оценки состояния в линейно-гауссовских моделях пространства состояний. |
| **EM** | Алгоритм ожидания-максимизации — итеративный метод оценки параметров в моделях со скрытыми переменными. Применяется для подгонки моделей пространства состояний. |
| **GARCH** | Обобщённая авторегрессионная условная гетероскедастичность — модель волатильности, где дисперсия зависит от прошлых квадратов остатков и прошлых дисперсий. |
| **Стохастическая волатильность (SV)** | Модель со скрытой переменной, где логарифм дисперсии следует AR(1)-процессу. Более гибкая, чем GARCH. |
| **Модель пространства состояний** | Модель со скрытыми состояниями, эволюционирующими во времени и наблюдаемыми через зашумлённое уравнение измерения. |

## Анализ выживаемости

| Термин | Определение |
|--------|------------|
| **Функция риска (hazard)** | Мгновенная интенсивность наступления события в момент t при условии дожития до t. |
| **Функция выживаемости S(t)** | Вероятность дожить до момента t. |
| **Цензурирование** | Когда время события наблюдается лишь частично (например, пациент жив на конец исследования — правое цензурирование). |
| **Модель Вейбулла** | Параметрическая модель выживаемости с параметрами формы и масштаба; включает экспоненциальную как частный случай. |

## Каузальный вывод и эконометрика

| Термин | Определение |
|--------|------------|
| **IV / 2SLS** | Инструментальные переменные / двухшаговый МНК — оценивает каузальные эффекты при ненаблюдаемых конфаундерах, используя инструмент. |
| **DID** | Разность разностей — оценивает эффект лечения, сравнивая изменения до/после в группах лечения и контроля. |
| **AIPW** | Аугментированное обратное взвешивание по вероятности — дважды робастный оцениватель, комбинирующий регрессию исхода и propensity score. |
| **Propensity score** | Оценённая вероятность получить лечение при данных ковариатах; используется для взвешивания или сопоставления. |
| **Панельные данные** | Данные с повторными наблюдениями во времени для множества объектов (поперечный временной ряд). |
| **Фиксированные эффекты (эконометрические)** | Специфичные для объекта свободные члены, поглощающие ненаблюдаемую гетерогенность, постоянную во времени. |

## Фармакометрика (PK/PD)

| Термин | Определение |
|--------|------------|
| **PK** | Фармакокинетика — изучение того, как лекарство перемещается по организму (абсорбция, распределение, метаболизм, выведение). |
| **PD** | Фармакодинамика — изучение биологических эффектов лекарства как функции его концентрации. |
| **NLME** | Нелинейная смешанная модель — популяционная модель PK/PD с фиксированными (популяционными) и случайными (индивидуальными) параметрами. |
| **Камерная модель** | Представляет организм как связанные камеры (например, ЖКТ, центральная, периферическая) с переносом первого порядка. |
| **Клиренс (CL)** | Объём плазмы, полностью очищаемый от лекарства в единицу времени. |
| **Объём распределения (V)** | Кажущийся объём, в котором лекарство распределяется в организме. |
| **Скорость абсорбции (Ka)** | Константа скорости первого порядка для абсорбции лекарства из ЖКТ в центральную камеру. |
| **Биодоступность (F)** | Доля введённой дозы, достигающая системного кровотока. |
| **LLOQ** | Нижний предел количественного определения — наименьшая концентрация, которую можно надёжно измерить. Обработка значений ниже LLOQ: игнорирование, замена половиной, цензурированное правдоподобие. |
| **Случайные эффекты (PK)** | Индивидуальные отклонения от популяционных параметров, обычно логнормальные: `CL_i = CL_pop × exp(η_i)`. |

## Физика высоких энергий (HEP)

| Термин | Определение |
|--------|------------|
| **HistFactory** | Формат рабочего пространства биннированного правдоподобия, широко используемый в физике частиц. NextStat читает JSON, совместимый с pyhf. |
| **pyhf** | Python-реализация правдоподобия HistFactory. JSON-формат NextStat совместим с pyhf. |
| **CLs** | Модифицированный частотный уровень доверия — метод установки верхних пределов, избегающий исключения сигналов, к которым эксперимент нечувствителен. |
| **Датасет Асимова** | Синтетический датасет, где все наблюдаемые равны ожидаемым значениям (без статистической флуктуации). Используется для ожидаемых пределов. |
| **Сила сигнала (μ)** | Параметр интереса в поиске: μ = 0 — только фон, μ = 1 — номинальная сигнальная гипотеза. |
| **Систематическая неопределённость** | Источник неопределённости помимо статистических флуктуаций (например, калибровка детектора, теоретические допущения). |
| **NormSys** | Мультипликативная систематика нормировки: ожидаемый выход умножается на фактор, зависящий от мешающего параметра α. |
| **HistoSys** | Систематика формы: содержимое бинов интерполируется между шаблонами up/down как функция α. |
| **Ранжирующий график (ranking)** | Показывает влияние каждого мешающего параметра на POI, сравнивая подгонки с фиксированным и свободным параметром. |
| **TRExFitter** | Фреймворк для анализа в физике частиц на основе HistFactory. NextStat может импортировать конфиги TRExFitter `.config`. |
| **RooFit** | Набор инструментов статистического моделирования в ROOT. NextStat валидирует небиннированные подгонки, сравнивая с RooFit. |
| **HS3** | HEP Statistics Serialization Standard — JSON-схема для обмена статистическими моделями между фреймворками. |

## Небиннированный анализ

| Термин | Определение |
|--------|------------|
| **Расширенное правдоподобие** | Правдоподобие, где общее число событий пуассоновски распределено с ожидаемым выходом ν, и каждое событие имеет плотность вероятности p(x). |
| **Смесевая модель** | PDF — взвешенная сумма компонентных PDF: `p(x) = Σ (ν_k / ν_tot) × p_k(x)`. |
| **Нормализующий поток** | Нейронная сеть, обучающая обратимое отображение из простого базового распределения в сложную целевую плотность. |
| **FlowPdf** | ONNX-обёртка нормализующего потока в NextStat; используется как PDF процесса в небиннированных подгонках. |
| **DcrSurrogate** | Условный поток, заменяющий биннированный морфинг шаблонов на гладкий, непрерывный нейронный суррогат. |
| **FAIR-HUC** | Протокол обучения DCR-суррогатов: генерация из шаблонов HistFactory при множестве α-точек, обучение условного NSF, валидация нормировки. |
| **EventStore** | Столбцовое хранилище событий NextStat в памяти для небиннированных данных. Поддерживает Parquet I/O и поэвентные веса. |

## GPU и инфраструктура

| Термин | Определение |
|--------|------------|
| **CUDA** | Вычислительная платформа NVIDIA для GPU. NextStat использует f64-точность для ядер CUDA. |
| **Metal** | GPU API Apple для Apple Silicon. NextStat использует f32-точность для шейдеров Metal. |
| **Контракт GPU-паритета** | Допуски, гарантирующие, что результаты GPU-ускоренных вычислений совпадают с CPU в рамках заданных границ (см. `docs/gpu-contract.md`). |
| **Пакетная подгонка (batch fitting)** | Запуск множества независимых подгонок (например, тойных экспериментов) параллельно на GPU с общим ядром NLL. |
| **Данные на устройстве (device-resident)** | Данные, остающиеся на GPU между операциями, без копирования хост↔устройство. |
| **TensorRT** | Оптимизатор инференса NVIDIA. NextStat может использовать TensorRT EP для оценки нейронных потоков с кэшированием движка. |

## Форматы данных

| Термин | Определение |
|--------|------------|
| **pyhf JSON** | JSON-формат рабочего пространства HistFactory (каналы, образцы, модификаторы, наблюдения). |
| **HS3 JSON** | JSON-формат HEP Statistics Serialization Standard для общих статистических моделей. |
| **Parquet** | Столбцовый формат хранения Apache. Используется как для биннированных таблиц гистограмм, так и для небиннированных событий. |
| **Arrow** | Столбцовый формат Apache для представления данных в памяти. NextStat использует Arrow record batches как промежуточный слой для Parquet I/O. |
| **SoA** | Structure-of-Arrays — компоновка данных, где наблюдаемые хранятся как непрерывные вектора по столбцам для эффективного доступа на GPU. |
